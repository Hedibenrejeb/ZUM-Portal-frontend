<div class="container-fluid" [hidden]="!isManager" >

<div class="col-lg-12" >
  <div class="card bg-info text-white-50 ">
    <div class="card-body">
      <h5 class="mt-0 mb-4 text-white"><i class="mdi mdi-alert-circle-outline mr-3"></i>Info </h5>
      <p class="card-text"> Kanban Board is not accessible for the Manager . Please choose project to manipulate the tasks.</p>
    
      <a href="javascript: void(0);" [routerLink]="['/p/projects/list']" class="color-white"> <i class="fa fa-arrow-right"></i>  List Project</a>

    </div>
  </div>
</div>
</div>

<div class="container-fluid" [hidden]="!isSimpleUser"  >

  
  <!-- start page title -->
  <app-page-title title="Kanban Board" [breadcrumbItems]="breadCrumbItems"></app-page-title>
  <!-- end page title -->

  <div class="row">
    <div class="col-lg-4">
      <div class="card ">


        <div class="card-body">


          <h4 class="card-title mb-4">Upcoming</h4>
          <div class="scroller">

            <ng-container>
              <ul class="sortable-list taskList list-unstyled ui-sortable" id="completed">
                <li *ngFor="let task of tasksUnstarted" class="task-warning ui-sortable-handle shadow-sm" id="task1">
                  <div class="dropdown float-end" ngbDropdown>
                    <a href="javascript: void(0);" class="dropdown-toggle arrow-none" ngbDropdownToggle>
                      <i class="mdi mdi-dots-vertical m-0 text-muted h5"></i>
                    </a>

                    <div class="dropdown-menu dropdown-menu-end" ngbDropdownMenu>
                      <a class="dropdown-item text-success" href="javascript: void(0);" (click)="onEditTask(task)">
                        <span class="fa-stack">
                          <i class="fa fa-pencil-alt fa-stack-1x fa-inverse text-success"></i>
                        </span> Edit
                      </a>
                      <a class="dropdown-item text-danger" href="javascript: void(0);"
                        (click)="onSelectTask(task);deleteMD(deleteModal)">
                        <span class="fa-stack">
                          <i class="fa fa-trash fa-stack-1x fa-inverse text-danger"></i>
                        </span> Delete
                      </a>
                      <a class="dropdown-item text-warning" href="javascript: void(0);" (click)="onSelectTask(task);detailsModal(scrollDataModal)">
                        <span class="fa-stack">
                          <i class="fa fa-search-plus fa-stack-1x fa-inverse text-warning"></i>
                        </span> Details


                      </a>

                    </div>
                   <!--  <div class="dropdown-menu dropdown-menu-end" ngbDropdownMenu>
                      <a class="dropdown-item" href="javascript: void(0);" (click)="onEditTask(task)">Edit</a>
                      <a class="dropdown-item" href="javascript: void(0);"
                        (click)="onSelectTask(task);deleteMD(deleteModal)">Delete</a>
                      <a class="dropdown-item" href="javascript: void(0);" (click)="onSelectTask(task);detailsModal(scrollDataModal)">Details</a>

                    </div> -->
                  </div>
                  <div class="float-end ms-2">
                    <span class="badge rounded-pill badge-soft-secondary font-size-12" [ngClass]=" { 
                          'badge-soft-secondary': task.status=== 'UNSTARTED',
                          'badge-soft-success': task.status === 'COMPLETED',
                          'badge-soft-primary': task.status === 'INPROGRESS',
                          'badge-soft-warning': task.status === 'CANCEL' }">{{task.project.name}}</span>
                  </div>
                  <h5 class="font-size-15">{{task.name}} </h5>
                  <div class="clearfix"> {{task.description}} </div>
                  <div class="mt-3">

                  </div>



                  <div class="card-body text-end ">

                    <!-- <div class="float-start ms-2 btn-group btn-group-sm">
                        <p class="mb-0 text-muted">By: {{task.creator.email}} </p>
                       
                     </div> -->
                    <div class="float-start ms-2 btn-group btn-group-sm ">
                      <p class="mb-0 text-muted">{{task.enddate}}</p>
                    </div>
                    <div class="float-end ms-2 btn-group btn-group-sm">
                      <p class="mb-0 text-muted">To: {{task.affectedTo.email}} </p>

                    </div>
                  </div>



                </li>




              </ul><a href="#" class="btn btn-custom btn-block mt-3 waves-effect waves-light"></a>
            </ng-container>
          </div>
          <div class="text-center d-grid">
            <a href="javascript: void(0);" [routerLink]="['/p/tasks/create']" class="btn btn-primary color-white"><i
                class="mdi mdi-plus me-1"></i>
              Add New</a>
          </div>
        </div>
      </div>
    </div>
    <!-- end col -->

    <div class="col-lg-4">
      <div class="card">
        <div class="card-body ">

          <h4 class="card-title mb-4">In Progress</h4>

          <div class="scroller">
            <ng-container>
              <ul class="sortable-list taskList list-unstyled ui-sortable" id="completed">
                <li *ngFor="let task of tasksInprogress" class="task-warning ui-sortable-handle shadow-sm" id="task1">
                  <div class="dropdown float-end" ngbDropdown>
                    <a href="javascript: void(0);" class="dropdown-toggle arrow-none" ngbDropdownToggle>
                      <i class="mdi mdi-dots-vertical m-0 text-muted h5"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end" ngbDropdownMenu>
                      <a class="dropdown-item text-success" href="javascript: void(0);" (click)="onEditTask(task)">
                        <span class="fa-stack">
                          <i class="fa fa-pencil-alt fa-stack-1x fa-inverse text-success"></i>
                        </span> Edit
                      </a>
                      <a class="dropdown-item text-danger" href="javascript: void(0);"
                        (click)="onSelectTask(task);deleteMD(deleteModal)">
                        <span class="fa-stack">
                          <i class="fa fa-trash fa-stack-1x fa-inverse text-danger"></i>
                        </span> Delete
                      </a>
                      <a class="dropdown-item text-warning" href="javascript: void(0);" (click)="onSelectTask(task);detailsModal(scrollDataModal)">
                        <span class="fa-stack">
                          <i class="fa fa-search-plus fa-stack-1x fa-inverse text-warning"></i>
                        </span> Details


                      </a>

                    </div>
                  </div>
                  <div class="float-end ms-2">
                    <span class="badge rounded-pill badge-soft-secondary font-size-12" [ngClass]=" { 
                              'badge-soft-secondary': task.status=== 'UNSTARTED',
                              'badge-soft-success': task.status === 'COMPLETED',
                              'badge-soft-primary': task.status === 'INPROGRESS',
                              'badge-soft-warning': task.status === 'CANCEL' }">{{task.project.name}}</span>
                  </div>
                  <h5 class="font-size-15">{{task.name}} </h5>
                  <div class="clearfix"> {{task.description}} </div>
                  <div class="mt-3">

                  </div>



                  <div class="card-body text-end ">

                    <!-- <div class="float-start ms-2 btn-group btn-group-sm">
                            <p class="mb-0 text-muted">By: {{task.creator.email}} </p>
                           
                         </div> -->
                    <div class="float-start ms-2 btn-group btn-group-sm ">
                      <p class="mb-0 text-muted">{{task.enddate}}</p>
                    </div>
                    <div class="float-end ms-2 btn-group btn-group-sm">
                      <p class="mb-0 text-muted">To: {{task.affectedTo.email}} </p>

                    </div>
                  </div>



                </li>




              </ul><a href="#" class="btn btn-custom btn-block mt-3 waves-effect waves-light"></a>

            </ng-container>
          </div>

          <div class="text-center d-grid">
            <a href="javascript: void(0);" [routerLink]="['/p/tasks/create']" class="btn btn-primary color-white"><i
                class="mdi mdi-plus me-1"></i>
              Add New</a>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card">
        <div class="card-body">


          <h4 class="card-title mb-4">Completed</h4>
          <div class="scroller">


            <ng-container>
              <ul class="sortable-list taskList list-unstyled ui-sortable" id="completed">
                <li *ngFor="let task of tasksCompleted" class="task-warning ui-sortable-handle shadow-sm" id="task1">
                  <div class="dropdown float-end" ngbDropdown>
                    <a href="javascript: void(0);" class="dropdown-toggle arrow-none" ngbDropdownToggle>
                      <i class="mdi mdi-dots-vertical m-0 text-muted h5"></i>
                    </a>

                    <div class="dropdown-menu dropdown-menu-end" ngbDropdownMenu>
                      <a class="dropdown-item text-success" href="javascript: void(0);" (click)="onEditTask(task)">
                        <span class="fa-stack">
                          <i class="fa fa-pencil-alt fa-stack-1x fa-inverse text-success"></i>
                        </span> Edit
                      </a>
                      <a class="dropdown-item text-danger" href="javascript: void(0);"
                        (click)="onSelectTask(task);deleteMD(deleteModal)">
                        <span class="fa-stack">
                          <i class="fa fa-trash fa-stack-1x fa-inverse text-danger"></i>
                        </span> Delete
                      </a>
                      <a class="dropdown-item text-warning" href="javascript: void(0);" (click)="onSelectTask(task);detailsModal(scrollDataModal)">
                        <span class="fa-stack">
                          <i class="fa fa-search-plus fa-stack-1x fa-inverse text-warning"></i>
                        </span> Details


                      </a>

                    </div></div>






                  <div class="float-end ms-2">
                    <span class="badge rounded-pill badge-soft-secondary font-size-12" [ngClass]=" { 
                              'badge-soft-secondary': task.status=== 'UNSTARTED',
                              'badge-soft-success': task.status === 'COMPLETED',
                              'badge-soft-primary': task.status === 'INPROGRESS',
                              'badge-soft-warning': task.status === 'CANCEL' }">{{task.project.name}}</span>
                  </div>
                  <h5 class="font-size-15">{{task.name}} </h5>
                  <div class="clearfix"> {{task.description}} </div>

                  <!--  <div class="mt-3 font-size-small ">
                          <p class="text-muted mb-4">To: {{task.affectedTo.email}} </p>
                        </div>
                        <div class="mt-3 font-size-small">
                          <p class="text-muted mb-4">{{task.enddate}} </p>
                       </div>
 -->



                  <div class="card-body text-end ">
                    <div class="float-start ms-2 btn-group btn-group-sm">
                      <p class="mb-0 float-start text-muted">{{task.enddate}} </p>
                    </div>
                    <!-- <div class="float-start ms-2 btn-group btn-group-sm">
                          <p class="mb-0 text-muted">By: {{task.creator.email}} </p>
                         
                       </div> -->
                    <div class="float-end ms-2 btn-group btn-group-sm">
                      <p class="mb-0 text-muted">To: {{task.affectedTo.email}}</p>
                    </div>

                  </div>
                 <!--  <div class="card-body text-end ">


                    <div class="float-end ms-2 btn-group btn-group-sm">

                      <a class="table-link  text-warning" (click)="onSelectTask(task);detailsModal(scrollDataModal)">
                        <span class="fa-stack">
                          <i class="fa fa-square fa-stack-2x"></i>
                          <i class="fa fa-search-plus fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                      <a class="table-link  text-info" (click)="onEditTask(task)">
                        <span class="fa-stack">
                          <i class="fa fa-square fa-stack-2x"></i>
                          <i class="fa fa-pencil-alt fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>

                      <a class="table-link text-danger" (click)="onSelectTask(task);deleteMD(deleteModal)">
                        <span class="fa-stack">
                          <i class="fa fa-square fa-stack-2x"></i>
                          <i class="fa fa-trash fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </div>
                  </div>
 -->


                </li>




              </ul><a href="#" class="btn btn-custom btn-block mt-3 waves-effect waves-light"></a>



            </ng-container>
          </div>

          <div class="text-center d-grid">
            <a href="javascript: void(0);" [routerLink]="['/p/tasks/create']" class="btn btn-primary color-white"><i
                class="mdi mdi-plus me-1"></i>
              Add New</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>




<!-- modal  -->


<!-- Delete task Large modal  templete -->

<ng-template #deleteModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title mt-0">Delete Task </h5>
    <button type="button" class="btn-close" id="delete-close" (click)="modal.dismiss('Cross click')"
      aria-hidden="true"></button>
  </div>
  <div class="modal-body">
    <p class="mb-0">Are you sure you want to delete this task</p>
  </div>
  <div class="modal-footer">


    <button type="button" class="btn btn-danger btn-label waves-light" (click)="modal.close('Close click')"><i
        class="bx bx-block label-icon "></i> No</button>
    <button type="button" class="btn btn-success btn-label waves-light" (click)="onDeleteTask(this.selectedTask.id)"><i
        class="bx bx-check-double label-icon"></i>
      Yes</button>

  </div>
</ng-template>


<!-- scroller modal   -->
<!-- <div class="col-sm-6 col-md-4 col-xl-3">
  <div class="my-4 text-center">
    <p class="text-muted">Scrollable modal</p>
    <button type="button" class="btn btn-primary" (click)="detailsModal(scrollDataModal)">Scrollable
      modal</button>
  </div>
</div>
 -->

<!-- Scrollable Modal -->
<ng-template #scrollDataModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title mt-0"> <i class="fas fa-money-check"></i>Task Details</h5>
    <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')" aria-label="Close">
    </button>
  </div>
  <div class="modal-body">

    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-12 col-sm-auto ">
            
          </div>
          <div class="col d-flex flex-column flex-sm-row justify-content-between ">
            <div class="text-left text-sm-left  mb-sm-0">

              <h5 class="pt-sm-2 pb-1 mb-0 text-nowrap"><i class="fas fa-user-shield">
                  Created
                  by:
                  {{selectedTask.creator.firstname}}</i>
              </h5>

              <div class="">
                <i class="fa fa-shield-alt float-right">
                  {{selectedTask.creator.role}}</i>

              </div>


              <div class="text-muted"><small>
                  <div class=""> Contact: </div>
                  {{selectedTask.creator.email}}
                </small></div>


            </div>

            <div class="text-center text-sm-right">

              

              <div *ngIf="selectedTask.startdate" class="text-muted">
                <small> Start Date :
                </small>
              </div>
              <div *ngIf="selectedTask.startdate" class="text-muted">
                <small>
                  {{selectedTask.startdate | date:'shortDate'
                  }}</small>
              </div>
              <div class="text-muted" *ngIf="selectedTask.enddate"><small>Due Date
                </small></div>
              <div *ngIf="selectedTask.enddate" class="text-muted"><small>
                  {{selectedTask.enddate|date:'shortDate'
                  }}</small></div>

                  <div *ngIf="selectedTask.createdate" class="text-muted">
                    <small> Creation Date :
                    </small>
                  </div>
                  <div *ngIf="selectedTask.createdate" class="text-muted">
                    <small>
                      {{selectedTask.createdate | date:'shortDate'
                      }}</small>
                  </div>
              <div *ngIf="selectedTask.updatedate" class="text-muted"><small>Last Updated Date
                </small></div>
              <div *ngIf="selectedTask.updatedate" class="text-muted"><small>
                  {{selectedTask.updatedate|date:'shortDate'
                  }}</small></div>
            </div>
          </div>
        </div>
      </div>

      <ul class="list-group list-group-flush">
        <li class="list-group-item"></li>
        <li class="list-group-item">
          <i class="fas fa-folder-open"> Project Name :
            {{selectedTask.project.name}}</i>
        </li>
        <li class="list-group-item">
          <i class="fas fa-clipboard"> Task Name :
            {{selectedTask.name}}</i>
        </li>
        <li class="list-group-item">
          <i class="fas fa-info-circle"> Description :
            {{selectedTask.description}}
          </i>
        </li>


        <li class="list-group-item">
          <i class="fas fa-info-circle"> Status :
            {{selectedTask.status}}
          </i>
        </li>

        <li class="list-group-item">
          <i class="fas fa-user-tie ">Affected TO : {{selectedTask.affectedTo.email}} </i>
        </li>
       <!--  <li class="list-group-item">
          <i class="fas fa-users "> Participants : </i>
        </li> -->

       <!--  <div class="col-lg-7" id="cluster_info">
          <dl class="">
            <dd class="project-people">
              <a href="">{{selectedTask.affectedTo.firstname}}</a>
               <a href=""><img alt="image" class="img-circle" src="{{selectedSprint.chefAffecter.profileImageUrl}}"></a>
 
            </dd>
          </dl>
        </div> -->



      </ul>

    </div>


  </div>


  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Close click')">Close</button>
  </div>
</ng-template>

















<!-- Task  -->
<ng-template #TaskContent let-task='task'>
  <div class="card task-box">
    <div class="card-body">
      <div class="float-end ms-2">
        <span class="badge rounded-pill badge-soft-secondary font-size-12" [ngClass]=" { 
            'badge-soft-secondary': task.status=== 'UNSTARTED',
            'badge-soft-success': task.status === 'COMPLETED',
            'badge-soft-primary': task.status === 'INPROGRESS',
            'badge-soft-warning': task.status === 'CANCEL' }">{{task.name}}</span>
      </div>
      <div>
        <h5 class="font-size-15">{{task.name}} </h5>
        <p class="text-muted mb-4">{{task.description}}</p>

        <p class="text-muted mb-4">Start Date {{task.startdate}}</p>
        <p class="text-muted mb-4">End Date {{task.enddate}}</p>

      </div>

      <div class="text-end">
        <!--         <h5 class="font-size-15 mb-1">$Project {{task.project}}</h5>
 -->
        <p class="mb-0 text-muted">Project {{task.project}} </p>
      </div>
    </div>
  </div>
</ng-template>


